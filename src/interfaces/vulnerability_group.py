from uuid import UUID

from src.models import (
    VulnerabilityGroup,
    Configuration
)


class VulnerabilityGroupInterface:
    """
    Interface to consult vulnerability groups in DB
    """

    @staticmethod
    def find_by_identifier(identifier: UUID) -> VulnerabilityGroup:
        """
        Get a vulnerability group by identifier

        :param identifier: Identifier to search the Vulnerability group
        """
        
        filters = dict(
            identifier=identifier
        )

        return VulnerabilityGroup.objects(**filters).first()

    @staticmethod
    def find_by_configuration(configuration: Configuration):
        """
        Find all vulnerability groups by configuration

        :param configuration: Configuration to find
        """
        filters = dict(
            configuration=configuration
        )
        return VulnerabilityGroup.objects(**filters).all()
